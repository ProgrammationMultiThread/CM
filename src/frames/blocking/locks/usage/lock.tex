% SPDX-License-Identifier: CC-BY-SA-4.0
% Author: Matthieu Perrin
% Part: 
% Section: 
% Sub-section: 
% Frame: 

\begingroup

\begin{frame}[fragile]{Verrou}

  \begin{tikzpicture}

    \draw[structure] (7,8.5) node{Exclusion mutuelle};
    \draw[structure] (5,4.2) node{Section critique};
    
    \draw (0,8.5) node[right]{\begin{minipage}{\textwidth} 
        \begin{block}{java.util.concurrent.locks.Lock}
          Objet informatique \alert{qui ne peut être possédé que par un thread à la fois.}
          \begin{lstlisting}[gobble=10]
            interface Lock {
              void lock()
              void unlock()
              void lockInterruptibly() throws InterruptedException
              boolean tryLock() 
              ...
            }
          \end{lstlisting}
    \end{block}\end{minipage}};

    \draw (0,5) node[right]{\begin{minipage}{.55\textwidth}
        \begin{exampleblock}{Java}
          \begin{lstlisting}[gobble=10]
            int value = 0;
            Lock lock = new ReentrantLock();

            void increment() {
              lock.lock();
              try{ (*\Structure{++value;}*) }
              finally{lock.unlock();}
            }
          \end{lstlisting}
        \end{exampleblock}
    \end{minipage}};

    \draw (6.5,5) node[right]{\begin{minipage}{.4\textwidth}
        \begin{exampleblock}{C++}
          \begin{lstlisting}[gobble=10]
            int value = 0;
            mutex lock;
            
            void increment() {
              lock_guard<mutex> g(lock);
              (*\Structure{++value;}*)
            }
          \end{lstlisting}
        \end{exampleblock}
    \end{minipage}};
  \end{tikzpicture}
  
\end{frame}

\endgroup
\endinput
