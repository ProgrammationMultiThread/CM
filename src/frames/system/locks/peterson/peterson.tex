% SPDX-License-Identifier: CC-BY-SA-4.0
% Author: Matthieu Perrin
% Part: 
% Section: 
% Sub-section: 
% Frame: 

\begingroup

\begin{frame}[fragile]{Algorithme de Peterson}

  \vspace{-12.4mm}
  On suppose deux processus, d'identifiants 0 et 1. 

  \begin{lstlisting}
    class PetersonLock implements Lock {
      private final (*\Structure{AtomicIntegerArray entering}*) = new AtomicIntegerArray(2);
      private volatile (*\Example{int priority = 0;}*)
      public void lock() {
        int i = ThreadID.get();
        (*\Structure{entering.set(i, 1);}*)
        (*\Example{priority = 1-i;}*)
        while( (*\Structure{entering.get(1-i) == 1}*) && (*\Example{priority != i}*) );
      }
      public void unlock() {
        int i = ThreadID.get();
        (*\Structure{entering.set(i, 0);}*)
      }
    }
  \end{lstlisting}

  \onExampleBlock[y=-23mm]{Exercice}{
    \begin{itemize}
    \item Cet algorithme respecte-t-il l'\example{exclusion mutuelle} ?
    \item Cet algorithme est-il \example{starvation-free} ?
    \end{itemize}
  }

  \on[bottom=-2mm]{
    \begin{citing}
    \item Gary L. Peterson. \textit{Myths About the Mutual Exclusion Problem.} IPL (1981)
      \jitem \lstinline{cm5/PetersonLock.java}
    \end{citing}
  }
  
\end{frame}

\endgroup
\endinput
